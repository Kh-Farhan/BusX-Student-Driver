{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"D:\\\\University\\\\FYP\\\\BusX\\\\Student\\\\Screens\\\\SetNearby.js\";\nimport React, { useState, useEffect, useContext, useRef, createRef } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Switch from \"react-native-web/dist/exports/Switch\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport { StudentContext } from \"../ContextApi\";\nimport MapView, { Marker } from 'react-native-maps';\nimport * as Location from \"expo-location\";\nimport variable from \"../localhost\";\nimport { Ionicons, Entypo, MaterialIcons } from '@expo/vector-icons';\nimport { GooglePlacesAutocomplete } from 'react-native-google-places-autocomplete';\n\nvar _Dimensions$get = Dimensions.get('window'),\n    width = _Dimensions$get.width,\n    height = _Dimensions$get.height;\n\nexport function SetNearby(_ref) {\n  var _this = this;\n\n  var navigation = _ref.navigation,\n      route = _ref.route;\n  var Sdata = useContext(StudentContext);\n\n  var _useState = useState(Sdata),\n      _useState2 = _slicedToArray(_useState, 2),\n      data = _useState2[0],\n      setData = _useState2[1];\n\n  var _useState3 = useState(),\n      _useState4 = _slicedToArray(_useState3, 2),\n      initial = _useState4[0],\n      setInitial = _useState4[1];\n\n  var _useState5 = useState(data.nearbyAlert),\n      _useState6 = _slicedToArray(_useState5, 2),\n      marker = _useState6[0],\n      setMarker = _useState6[1];\n\n  var _Dimensions$get2 = Dimensions.get('window'),\n      width = _Dimensions$get2.width,\n      height = _Dimensions$get2.height;\n\n  var SCREEN_HEIGHT = height;\n  var SCREEN_WIDTH = width;\n  var ASPECT_RATIO = width / height;\n  var LATITUDE_DELTA = 0.0922;\n  var LONGITUDE_DELTA = LATITUDE_DELTA * ASPECT_RATIO;\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      modalVisible = _useState8[0],\n      setModalVisible = _useState8[1];\n\n  var _useState9 = useState(),\n      _useState10 = _slicedToArray(_useState9, 2),\n      modalText = _useState10[0],\n      setModalText = _useState10[1];\n\n  var mapView = useRef(null);\n  var searchRef = useRef(null);\n\n  var _useState11 = useState(\" \"),\n      _useState12 = _slicedToArray(_useState11, 2),\n      locName = _useState12[0],\n      setlocName = _useState12[1];\n\n  useEffect(function () {\n    navigation.setOptions({\n      headerRight: function headerRight() {\n        return React.createElement(TouchableOpacity, {\n          onPress: function onPress() {\n            return navigation.goBack();\n          },\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 29,\n            columnNumber: 9\n          }\n        }, React.createElement(Ionicons, {\n          style: {\n            marginRight: 10,\n            marginTop: 5\n          },\n          name: \"arrow-back\",\n          size: 28,\n          color: \"black\",\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 30,\n            columnNumber: 5\n          }\n        }));\n      }\n    });\n    setInitial({\n      latitude: marker.latitude,\n      longitude: marker.longitude,\n      latitudeDelta: LATITUDE_DELTA,\n      longitudeDelta: LONGITUDE_DELTA\n    });\n  }, []);\n  useEffect(function () {\n    if (mapView.current !== null) {\n      mapView.current.animateToRegion({\n        longitude: marker.longitude,\n        latitude: marker.latitude,\n        latitudeDelta: LATITUDE_DELTA,\n        longitudeDelta: LONGITUDE_DELTA\n      }, 1000);\n    }\n  }, [marker]);\n\n  var clearIn = function clearIn() {\n    if (searchRef.current !== null) {\n      searchRef.current.setAddressText(\"\");\n    }\n  };\n\n  var SetNearby = function SetNearby() {\n    console.log(marker);\n    fetch(\"http://\" + variable.localhost + \":5000/student/setNearby\", {\n      method: 'POST',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        id: data._id,\n        coordinates: marker\n      })\n    }).then(function (response) {\n      return response.json();\n    }).catch(function (error) {\n      return console.error(\"ErrorHere: \", error);\n    }).then(function (response) {\n      if (response.message) {\n        console.log(response.message);\n        setModalText(response.message);\n        setModalVisible(true);\n      }\n\n      if (response.Success) {\n        console.log(response.Success);\n        setModalText(response.Success);\n        setModalVisible(true);\n      }\n    });\n  };\n\n  var view = React.createElement(View, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 13\n    }\n  }, React.createElement(GooglePlacesAutocomplete, {\n    ref: searchRef,\n    placeholder: \"Search\",\n    renderRightButton: function renderRightButton() {\n      return React.createElement(TouchableOpacity, {\n        onPress: clearIn,\n        style: styles.clearButton,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 28\n        }\n      }, React.createElement(MaterialIcons, {\n        name: \"delete\",\n        size: 34,\n        color: \"#FfC329\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 91\n        }\n      }));\n    },\n    onPress: function onPress(data) {\n      var details = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      fetch(\"https://maps.googleapis.com/maps/api/place/details/json?place_id=\" + data.place_id + \"&fields=geometry,name&key=AIzaSyAJqGtli38VmOucpZPA1teyivLeYmojhMQ\", {\n        method: 'GET'\n      }).then(function (response) {\n        return response.json();\n      }).catch(function (error) {\n        return console.error(\"ErrorHere: \", error);\n      }).then(function (response) {\n        setlocName(response.result.name);\n        var coordinates = response.result.geometry.location;\n        var mark = {\n          latitude: coordinates.lat,\n          longitude: coordinates.lng\n        };\n        setMarker(mark);\n      });\n    },\n    query: {\n      key: 'AIzaSyAJqGtli38VmOucpZPA1teyivLeYmojhMQ',\n      language: 'en',\n      components: 'country:pk'\n    },\n    styles: {\n      container: {\n        marginLeft: 10,\n        marginTop: 1,\n        width: \"95%\",\n        zIndex: 2,\n        position: \"absolute\"\n      },\n      textInputContainer: {\n        flexDirection: 'row',\n        top: 10\n      },\n      textInput: {\n        backgroundColor: '#FFFFFF',\n        height: 44,\n        borderColor: \"#FfC329\",\n        borderWidth: 1,\n        color: \"#293038\",\n        elevation: 5\n      },\n      listView: {\n        marginTop: 10,\n        borderColor: \"black\",\n        backgroundColor: \"#FfC329\",\n        elevation: 5\n      },\n      row: {\n        borderBottomColor: \"#FfC329\",\n        borderBottomWidth: 1\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 3\n    }\n  }), React.createElement(Modal, {\n    animationType: \"slide\",\n    transparent: true,\n    visible: modalVisible,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 5\n    }\n  }, React.createElement(View, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 9\n    }\n  }, React.createElement(View, {\n    style: styles.modalView,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 11\n    }\n  }, React.createElement(Text, {\n    style: styles.modalText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 13\n    }\n  }, modalText), React.createElement(TouchableOpacity, {\n    style: styles.SButton,\n    onPress: function onPress() {\n      setModalVisible(false);\n      navigation.navigate(\"Dashboard\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 13\n    }\n  }, React.createElement(Text, {\n    style: styles.ButtonText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 9\n    }\n  }, \"OK\"))))), React.createElement(MapView, {\n    style: styles.map,\n    ref: mapView,\n    moveOnMarkerPress: true,\n    initialRegion: initial,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 5\n    }\n  }, React.createElement(Marker, {\n    tracksViewChanges: false,\n    draggable: true,\n    coordinate: marker,\n    title: locName,\n    description: \"Notify Me when Bus is Here!!!\",\n    onDragEnd: function onDragEnd(e) {\n      setMarker({\n        latitude: e.nativeEvent.coordinate.latitude,\n        longitude: e.nativeEvent.coordinate.longitude\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 6\n    }\n  })), React.createElement(View, {\n    style: styles.Button,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 5\n    }\n  }, React.createElement(Button, {\n    title: \"Set Nearby \",\n    onPress: SetNearby,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 5\n    }\n  })));\n  return React.createElement(View, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 9\n    }\n  }, initial !== undefined && marker !== undefined ? view : React.createElement(View, {\n    style: styles.ActivityIndicator,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 59\n    }\n  }, React.createElement(ActivityIndicator, {\n    size: \"large\",\n    color: \"black\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 98\n    }\n  })));\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1\n  },\n  Button: {\n    position: 'absolute',\n    marginTop: height - 150,\n    backgroundColor: '#fff',\n    width: '70%',\n    alignSelf: 'center',\n    borderRadius: 5,\n    shadowColor: '#FfC329',\n    shadowOffset: {\n      width: 0,\n      height: 3\n    },\n    shadowOpacity: 0.5,\n    shadowRadius: 5,\n    elevation: 10\n  },\n  search: {\n    position: 'absolute',\n    marginTop: 70,\n    backgroundColor: '#fff',\n    width: '70%',\n    alignSelf: 'center',\n    borderRadius: 5,\n    shadowColor: '#FfC329',\n    shadowOffset: {\n      width: 0,\n      height: 3\n    },\n    shadowOpacity: 0.5,\n    shadowRadius: 5,\n    elevation: 10\n  },\n  modalView: {\n    width: \"90%\",\n    alignSelf: \"center\",\n    marginTop: \"100%\",\n    backgroundColor: \"white\",\n    borderRadius: 20,\n    borderWidth: 1,\n    borderColor: \"#FfC329\",\n    padding: 35,\n    alignItems: \"center\",\n    shadowColor: \"#FfC329\",\n    shadowOffset: {\n      width: 0,\n      height: 2\n    },\n    shadowOpacity: 0.25,\n    shadowRadius: 4,\n    elevation: 5\n  },\n  SButton: {\n    alignItems: \"center\",\n    marginTop: 10,\n    backgroundColor: \"#293038\",\n    width: 100,\n    height: 30,\n    borderRadius: 6,\n    paddingTop: \"1.5%\"\n  },\n  ButtonText: {\n    color: \"#FfC329\",\n    fontWeight: \"bold\",\n    alignSelf: \"center\",\n    textTransform: \"uppercase\"\n  },\n  modalText: {\n    textAlign: 'center',\n    color: \"#293038\",\n    fontSize: 20\n  },\n  image: {\n    marginTop: \"20%\",\n    width: 200,\n    height: 200,\n    shadowColor: \"yellow\",\n    shadowOffset: {\n      height: 2\n    },\n    shadowOpacity: 0.3\n  },\n  ActivityIndicator: {\n    flex: 1,\n    justifyContent: \"center\",\n    transform: [{\n      scaleX: 2.2\n    }, {\n      scaleY: 2.2\n    }]\n  },\n  map: {\n    width: Dimensions.get('window').width,\n    height: Dimensions.get('window').height - 1,\n    zIndex: 0\n  },\n  clearButton: {\n    marginTop: 4,\n    marginLeft: 5\n  }\n});","map":{"version":3,"sources":["D:/University/FYP/BusX/Student/Screens/SetNearby.js"],"names":["React","useState","useEffect","useContext","useRef","createRef","StudentContext","MapView","Marker","Location","variable","Ionicons","Entypo","MaterialIcons","GooglePlacesAutocomplete","Dimensions","get","width","height","SetNearby","navigation","route","Sdata","data","setData","initial","setInitial","nearbyAlert","marker","setMarker","SCREEN_HEIGHT","SCREEN_WIDTH","ASPECT_RATIO","LATITUDE_DELTA","LONGITUDE_DELTA","modalVisible","setModalVisible","modalText","setModalText","mapView","searchRef","locName","setlocName","setOptions","headerRight","goBack","marginRight","marginTop","latitude","longitude","latitudeDelta","longitudeDelta","current","animateToRegion","clearIn","setAddressText","console","log","fetch","localhost","method","headers","Accept","body","JSON","stringify","id","_id","coordinates","then","response","json","catch","error","message","Success","view","styles","clearButton","details","place_id","result","name","geometry","location","mark","lat","lng","key","language","components","container","marginLeft","zIndex","position","textInputContainer","flexDirection","top","textInput","backgroundColor","borderColor","borderWidth","color","elevation","listView","row","borderBottomColor","borderBottomWidth","modalView","SButton","navigate","ButtonText","map","e","nativeEvent","coordinate","Button","undefined","ActivityIndicator","StyleSheet","create","flex","alignSelf","borderRadius","shadowColor","shadowOffset","shadowOpacity","shadowRadius","search","padding","alignItems","paddingTop","fontWeight","textTransform","textAlign","fontSize","image","justifyContent","transform","scaleX","scaleY"],"mappings":"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","sourcesContent":["import React, { useState, useEffect,useContext,useRef,createRef} from \"react\";\r\nimport { StyleSheet, Text,Image, View,Button,TouchableOpacity,Switch,ActivityIndicator,Dimensions,Modal} from 'react-native';\r\nimport{StudentContext} from \"../ContextApi\";\r\nimport MapView,{Marker} from 'react-native-maps';\r\nimport * as Location from \"expo-location\";\r\nimport variable from \"../localhost\";\r\nimport { Ionicons,Entypo,MaterialIcons   } from '@expo/vector-icons';\r\nimport { GooglePlacesAutocomplete } from 'react-native-google-places-autocomplete';\r\nconst {width, height} = Dimensions.get('window');\r\nexport function SetNearby({ navigation,route }) {\r\nconst Sdata=useContext(StudentContext);\r\nconst[data,setData]=useState(Sdata);\r\nconst[initial,setInitial]=useState();\r\nconst[marker,setMarker]=useState(data.nearbyAlert)\r\nconst {width, height} = Dimensions.get('window')\r\nconst SCREEN_HEIGHT = height\r\nconst SCREEN_WIDTH = width\r\nconst ASPECT_RATIO = width / height\r\nconst LATITUDE_DELTA = 0.0922\r\nconst LONGITUDE_DELTA = LATITUDE_DELTA * ASPECT_RATIO;\r\nconst [modalVisible, setModalVisible] = useState(false);\r\nconst [modalText, setModalText] = useState();\r\nconst mapView =useRef(null);\r\nconst searchRef =useRef(null);\r\nconst [locName,setlocName]=useState(\" \");\r\n\r\nuseEffect(()=>{\r\n    navigation.setOptions({ headerRight:()=>( \r\n        <TouchableOpacity onPress={()=>navigation.goBack()}  >        \r\n    <Ionicons style={{marginRight:10,marginTop:5}}name=\"arrow-back\" size={28} color=\"black\" />\r\n    </TouchableOpacity>) });\r\n    setInitial({latitude:marker.latitude, longitude:marker.longitude,latitudeDelta:LATITUDE_DELTA,longitudeDelta:LONGITUDE_DELTA});\r\n    \r\n},[]);\r\nuseEffect(()=>{\r\n  if(mapView.current!==null){\r\n  mapView.current.animateToRegion({ // Takes a region object as parameter\r\n    longitude:marker.longitude,\r\n    latitude: marker.latitude,\r\n    latitudeDelta: LATITUDE_DELTA,\r\n    longitudeDelta: LONGITUDE_DELTA,\r\n},1000);\r\n}\r\n},[marker])\r\nconst clearIn=()=>{\r\n  if(searchRef.current!==null){\r\n    searchRef.current.setAddressText(\"\")\r\n  }\r\n}\r\nconst SetNearby=()=>{\r\n  console.log(marker);\r\n    fetch(`http://${variable.localhost}:5000/student/setNearby`, {\r\n            method: 'POST',\r\n            headers: {\r\n              Accept: 'application/json',\r\n              'Content-Type': 'application/json'\r\n            },\r\n            body:JSON.stringify({id:data._id,coordinates:marker})\r\n          })\r\n          .then(response => response.json())  \r\n          .catch(error=> console.error(\"ErrorHere: \",error))\r\n          .then(response=>{\r\n              if(response.message){\r\n                  console.log(response.message)\r\n                setModalText(response.message);\r\n                setModalVisible(true);\r\n              }\r\n              if(response.Success){\r\n                console.log(response.Success)\r\n                setModalText(response.Success);\r\n                setModalVisible(true);\r\n              }\r\n          });\r\n};\r\n\r\nconst view=(<View >\r\n  <GooglePlacesAutocomplete\r\n    ref={searchRef}\r\n     placeholder='Search'\r\n    renderRightButton={()=><TouchableOpacity onPress={clearIn} style={styles.clearButton}><MaterialIcons name=\"delete\" size={34} color=\"#FfC329\" /></TouchableOpacity>}\r\n     onPress={(data, details = null) => {\r\n      fetch(`https://maps.googleapis.com/maps/api/place/details/json?place_id=${data.place_id}&fields=geometry,name&key=AIzaSyAJqGtli38VmOucpZPA1teyivLeYmojhMQ`, {\r\n        method: 'GET'\r\n      })\r\n      .then(response => response.json())  \r\n      .catch(error=> console.error(\"ErrorHere: \",error))\r\n      .then(response=>{\r\n          setlocName(response.result.name);\r\n          const coordinates=response.result.geometry.location;\r\n          const mark={latitude:coordinates.lat,longitude:coordinates.lng};\r\n          setMarker(mark);\r\n\r\n      });\r\n     }}\r\n     query={{\r\n       key:'AIzaSyAJqGtli38VmOucpZPA1teyivLeYmojhMQ',\r\n       language: 'en',\r\n       components: 'country:pk'\r\n     }}\r\n     styles={{\r\n      container:{\r\n        marginLeft:10,\r\n        marginTop:1,\r\n        width:\"95%\",\r\n        zIndex: 2,\r\n        position:\"absolute\",\r\n       },\r\n       textInputContainer: {\r\n        flexDirection: 'row',\r\n        top:10,\r\n        \r\n      },\r\n      textInput: {\r\n        backgroundColor: '#FFFFFF',\r\n        height: 44,\r\n        borderColor:\"#FfC329\",\r\n        borderWidth:1,\r\n        color:\"#293038\",\r\n        elevation:5\r\n      },\r\n       listView:{\r\n         marginTop:10,\r\n         borderColor:\"black\",\r\n        backgroundColor:\"#FfC329\",\r\n        elevation:5\r\n       },\r\n       row:{\r\n        borderBottomColor:\"#FfC329\",\r\n        borderBottomWidth:1\r\n       }\r\n     }}\r\n   />\r\n    <Modal\r\n        animationType=\"slide\"\r\n        transparent={true}\r\n        visible={modalVisible}\r\n      >\r\n        <View>\r\n          <View style={styles.modalView}>\r\n            <Text style={styles.modalText}>{modalText}</Text>\r\n            <TouchableOpacity  style={styles.SButton} onPress={()=>{\r\n            setModalVisible(false);\r\n            navigation.navigate(\"Dashboard\")}}>\r\n        <Text style={styles.ButtonText} >OK</Text>\r\n        </TouchableOpacity>\r\n          </View>\r\n        </View>\r\n      </Modal>\r\n      \r\n    <MapView style={styles.map}\r\n    ref={mapView}\r\n    moveOnMarkerPress\r\n    initialRegion={initial}\r\n    ><Marker\r\n    tracksViewChanges={false}\r\n    draggable\r\n    coordinate={marker}\r\n    title={locName}\r\n    description=\"Notify Me when Bus is Here!!!\"\r\n    onDragEnd={e => {\r\n      setMarker({latitude:e.nativeEvent.coordinate.latitude,longitude:e.nativeEvent.coordinate.longitude});\r\n    }}\r\n  />\r\n  </MapView>\r\n    <View style={styles.Button}>\r\n    <Button title=\"Set Nearby \" onPress={SetNearby}></Button>\r\n  </View>\r\n    \r\n\r\n    </View>)\r\n    return (\r\n        <View  style={styles.container}>\r\n            {initial!==undefined&&marker!==undefined?view:<View style={styles.ActivityIndicator}><ActivityIndicator  size=\"large\" color=\"black\"/></View>}\r\n            </View>\r\n      \r\n    );\r\n  }\r\n\r\n  const styles = StyleSheet.create({\r\n    container: {\r\n      flex: 1,\r\n    }, \r\n    Button:{\r\n    position:'absolute', \r\n    marginTop: height-150, \r\n    backgroundColor: '#fff',\r\n    width: '70%',\r\n    alignSelf:'center',\r\n    borderRadius: 5,\r\n    shadowColor: '#FfC329',\r\n    shadowOffset: { width: 0, height: 3 },\r\n    shadowOpacity: 0.5,\r\n    shadowRadius: 5,\r\n    elevation: 10,\r\n    },\r\n    search:{\r\n      position:'absolute', \r\n      marginTop:70, \r\n      backgroundColor: '#fff',\r\n      width: '70%',\r\n      alignSelf:'center',\r\n      borderRadius: 5,\r\n      shadowColor: '#FfC329',\r\n      shadowOffset: { width: 0, height: 3 },\r\n      shadowOpacity: 0.5,\r\n      shadowRadius: 5,\r\n      elevation: 10,\r\n      },\r\n    modalView: {\r\n        width:\"90%\",\r\n        alignSelf:\"center\",\r\n        marginTop: \"100%\",\r\n        backgroundColor: \"white\",\r\n        borderRadius: 20,\r\n        borderWidth:1,\r\n        borderColor:\"#FfC329\",\r\n        padding: 35,\r\n        alignItems: \"center\",\r\n        shadowColor: \"#FfC329\",\r\n        shadowOffset: {\r\n          width: 0,\r\n          height: 2\r\n        },\r\n        shadowOpacity: 0.25,\r\n        shadowRadius: 4,\r\n        elevation: 5\r\n      },\r\n      SButton:{\r\n        alignItems: \"center\",\r\n        marginTop:10,\r\n        backgroundColor:\"#293038\",\r\n        width:100,\r\n        height:30,\r\n        borderRadius:6,\r\n        paddingTop:\"1.5%\",\r\n      \r\n      },\r\n      ButtonText:{\r\n        color: \"#FfC329\",\r\n        fontWeight: \"bold\",\r\n        alignSelf: \"center\",\r\n        textTransform: \"uppercase\"\r\n      },\r\n      modalText:{\r\n        textAlign: 'center',\r\n      color:\"#293038\",\r\n      fontSize:20\r\n      },\r\n    image: {\r\n        marginTop:\"20%\",\r\n        width: 200,\r\n        height: 200,\r\n        shadowColor: \"yellow\",\r\n      shadowOffset: { height: 2},\r\n      shadowOpacity: 0.3,\r\n      },\r\n      ActivityIndicator:{\r\n        flex: 1,\r\n        justifyContent: \"center\",\r\n        transform: [{ scaleX: 2.2 }, { scaleY: 2.2 }]\r\n      },\r\n      map: {\r\n        width: Dimensions.get('window').width,\r\n        height: Dimensions.get('window').height-1,\r\n        zIndex: 0\r\n      },\r\n    clearButton:{\r\n      marginTop:4,\r\n      marginLeft:5\r\n    }\r\n  });"]},"metadata":{},"sourceType":"module"}